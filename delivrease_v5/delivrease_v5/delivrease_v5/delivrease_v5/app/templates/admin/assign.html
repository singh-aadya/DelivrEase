{% extends "base.html" %}
{% block content %}
<h1 class="text-2xl font-extrabold mb-4">Assign Orders</h1>

<form method="post" class="grid md:grid-cols-2 gap-4 mb-6">
  <div>
    <label class="text-sm">Order</label>
    <select name="order_id" class="w-full mt-1 px-3 py-2 rounded-xl bg-black/30 border border-white/10">
  {% for o in orders %}
    <option value="{{ o.id }}" {% if request.args.get('order_id')|int == o.id %}selected{% endif %}>
      {{ o.title }} ({{ o.status }})
    </option>
  {% endfor %}
</select>

  </div>
  <div>
    <label class="text-sm">Agent</label>
    <select name="agent_id" class="w-full mt-1 px-3 py-2 rounded-xl bg-black/30 border border-white/10">
      {% for a in agents %}
        <option value="{{ a.id }}">{{ a.username }}</option>
      {% endfor %}
    </select>
  </div>
  <button class="px-4 py-2 rounded-xl bg-cyan-400 text-slate-900 font-bold">Assign</button>
</form>

{% if selected_order %}
  <h2 class="font-bold mb-2">Ranking for {{ selected_order.title }}</h2>
  <div class="overflow-x-auto rounded-xl border border-white/10">
  <table class="min-w-full">
    <thead class="bg-white/10"><tr><th class="p-3">Agent</th><th class="p-3">Score</th></tr></thead>
    <tbody>
      {% for item in ranked_agents %}
      <tr class="border-b border-white/10">
        <td class="p-3">{{ item.agent.username }}</td>
        <td class="p-3">{{ item.score }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  </div>
{% endif %}
{% endblock %}
